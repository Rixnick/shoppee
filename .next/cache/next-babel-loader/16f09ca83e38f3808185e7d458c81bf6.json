{"ast":null,"code":"import _regeneratorRuntime from \"/home/loki/Desktop/Projects/Shoppin/shop-client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/loki/Desktop/Projects/Shoppin/shop-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/home/loki/Desktop/Projects/Shoppin/shop-client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/home/loki/Desktop/Projects/Shoppin/shop-client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/loki/Desktop/Projects/Shoppin/shop-client/components/UserProductItem.jsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from 'react';\nimport fetch from 'isomorphic-unfetch';\nimport { useMutation } from '@apollo/react-hooks';\nimport { UPDATE_PRODUCT, MY_PRODUCTS, QUERY_PRODUCTS } from '../graphql/Products';\n\nvar UserProductItem = function UserProductItem(_ref) {\n  _s();\n\n  var product = _ref.product;\n\n  var _useState = useState(false),\n      edit = _useState[0],\n      setEdit = _useState[1];\n\n  var _useState2 = useState(null),\n      file = _useState2[0],\n      setFile = _useState2[1];\n\n  var _useState3 = useState(product),\n      productData = _useState3[0],\n      setProductData = _useState3[1];\n\n  var _useMutation = useMutation(UPDATE_PRODUCT, {\n    onCompleted: function onCompleted(data) {\n      //console.log(data)\n      setEdit(false);\n    },\n    refetchQueries: [{\n      query: QUERY_PRODUCTS\n    }, {\n      query: MY_PRODUCTS\n    }]\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      updateProduct = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      loading = _useMutation2$.loading,\n      error = _useMutation2$.error;\n\n  var handleChange = function handleChange(e) {\n    return setProductData(_objectSpread(_objectSpread({}, productData), {}, _defineProperty({}, e.target.name, e.target.value)));\n  };\n\n  var selectFile = function selectFile(e) {\n    var files = e.target.files;\n    setFile(files[0]); //console.log(files)\n  }; //Upload File to Cloudinary\n\n\n  var uploadFile = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var data, res, result;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              data = new FormData();\n              data.append('file', file);\n              data.append('upload_preset', 'shoppin');\n              _context.next = 5;\n              return fetch('https://api.cloudinary.com/v1_1/swizce/image/upload', {\n                method: 'post',\n                body: data\n              });\n\n            case 5:\n              res = _context.sent;\n              _context.next = 8;\n              return res.json();\n\n            case 8:\n              result = _context.sent;\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function uploadFile() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var url;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(!file && productData === product)) {\n                _context2.next = 4;\n                break;\n              }\n\n              setProductData(product);\n              setEdit(false);\n              return _context2.abrupt(\"return\");\n\n            case 4:\n              _context2.prev = 4;\n\n              if (!file) {\n                _context2.next = 16;\n                break;\n              }\n\n              _context2.next = 8;\n              return uploadFile();\n\n            case 8:\n              url = _context2.sent;\n\n              if (!url) {\n                _context2.next = 14;\n                break;\n              }\n\n              _context2.next = 12;\n              return updateProduct({\n                variables: _objectSpread(_objectSpread({}, productData), {}, {\n                  imageUrl: url,\n                  price: +productData.price\n                })\n              });\n\n            case 12:\n              _context2.next = 16;\n              break;\n\n            case 14:\n              _context2.next = 16;\n              return updateProduct({\n                variables: _objectSpread(_objectSpread({}, productData), {}, {\n                  imageUrl: productData.imageUrl,\n                  price: +productData.price\n                })\n              });\n\n            case 16:\n              _context2.next = 21;\n              break;\n\n            case 18:\n              _context2.prev = 18;\n              _context2.t0 = _context2[\"catch\"](4);\n              console.log(_context2.t0);\n\n            case 21:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[4, 18]]);\n    }));\n\n    return function handleSubmit() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    style: {\n      display: 'grid',\n      gridTemplateColumns: '2fr 2fr 2fr 2fr 2fr',\n      width: '100%',\n      borderTop: '1px solid grey',\n      borderBottom: '1px solid grey'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    style: {\n      margin: 'auto',\n      alignItems: 'center',\n      marginBottom: '5px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }\n  }, !edit ? __jsx(\"img\", {\n    src: product.imageUrl,\n    alt: product.description,\n    width: \"80px\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 26\n    }\n  }) : __jsx(\"input\", {\n    style: {\n      margin: '5px',\n      height: '30px'\n    },\n    type: \"file\",\n    name: \"file\",\n    placeholder: \"Enter Product Image\" //value={productData.imageUrl}\n    ,\n    onChange: selectFile,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 21\n    }\n  })), __jsx(\"div\", {\n    style: {\n      margin: 'auto',\n      alignItems: 'center',\n      marginBottom: '5px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  }, !edit ? __jsx(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 26\n    }\n  }, product.name) : __jsx(\"input\", {\n    style: {\n      margin: '5px',\n      height: '30px'\n    },\n    type: \"text\",\n    name: \"name\",\n    placeholder: \"Enter product name\",\n    value: productData.name,\n    onChange: handleChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 21\n    }\n  })), __jsx(\"div\", {\n    style: {\n      margin: 'auto',\n      alignItems: 'center',\n      marginBottom: '5px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }\n  }, !edit ? __jsx(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 26\n    }\n  }, product.description) : __jsx(\"input\", {\n    style: {\n      margin: '5px',\n      height: '30px'\n    },\n    type: \"text\",\n    name: \"description\",\n    placeholder: \"Enter product description\",\n    value: productData.description,\n    onChange: handleChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 21\n    }\n  })), __jsx(\"div\", {\n    style: {\n      margin: 'auto',\n      alignItems: 'center',\n      marginBottom: '5px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }, !edit ? __jsx(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 26\n    }\n  }, product.price, \"THB\") : __jsx(\"input\", {\n    style: {\n      margin: '5px',\n      height: '30px'\n    },\n    type: \"number\",\n    name: \"price\",\n    placeholder: \"Enter Product Price\",\n    value: productData.price,\n    onChange: handleChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 21\n    }\n  })), !edit ? __jsx(React.Fragment, null, __jsx(\"div\", {\n    style: _defineProperty({\n      margin: '5px',\n      alignItems: 'center',\n      display: 'flex'\n    }, \"alignItems\", 'center'),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 17\n    }\n  }, __jsx(\"button\", {\n    style: {\n      margin: '10px',\n      background: 'orange',\n      color: 'white',\n      padding: '10px',\n      border: 'none'\n    },\n    onClick: function onClick() {\n      return setEdit(true);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 21\n    }\n  }, \"Edit\"), __jsx(\"button\", {\n    style: {\n      margin: '10px',\n      background: 'red',\n      color: 'white',\n      padding: '10px',\n      border: 'none'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 21\n    }\n  }, \"Delete\"))) : __jsx(React.Fragment, null, __jsx(\"div\", {\n    style: _defineProperty({\n      margin: '5px',\n      alignItems: 'center',\n      display: 'flex'\n    }, \"alignItems\", 'center'),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 21\n    }\n  }, __jsx(\"button\", {\n    style: {\n      margin: '10px',\n      background: 'orange',\n      color: 'white',\n      padding: '10px',\n      border: 'none'\n    },\n    onClick: function onClick() {\n      return setEdit(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 25\n    }\n  }, \"Cancel\"), __jsx(\"button\", {\n    style: {\n      margin: '10px',\n      background: 'teal',\n      color: 'white',\n      padding: '10px',\n      border: 'none'\n    },\n    loading: true,\n    onClick: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 25\n    }\n  }, loading ? 'Editing...' : 'Updated'))));\n};\n\n_s(UserProductItem, \"3qGqvPS685Rf2ByK3skfYmYApSA=\", false, function () {\n  return [useMutation];\n});\n\n_c = UserProductItem;\nexport default UserProductItem;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserProductItem\");","map":{"version":3,"sources":["/home/loki/Desktop/Projects/Shoppin/shop-client/components/UserProductItem.jsx"],"names":["React","useState","fetch","useMutation","UPDATE_PRODUCT","MY_PRODUCTS","QUERY_PRODUCTS","UserProductItem","product","edit","setEdit","file","setFile","productData","setProductData","onCompleted","data","refetchQueries","query","updateProduct","loading","error","handleChange","e","target","name","value","selectFile","files","uploadFile","FormData","append","method","body","res","json","result","handleSubmit","url","variables","imageUrl","price","console","log","display","gridTemplateColumns","width","borderTop","borderBottom","margin","alignItems","marginBottom","description","height","background","color","padding","border"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport fetch from 'isomorphic-unfetch';\nimport { useMutation } from '@apollo/react-hooks';\nimport { UPDATE_PRODUCT, MY_PRODUCTS, QUERY_PRODUCTS } from '../graphql/Products';\n\nconst UserProductItem = ({ product }) => {\n    const [edit, setEdit] = useState(false)\n    const [file, setFile] = useState(null)\n    const [productData, setProductData] = useState(product)\n\n\n    const [updateProduct, { loading, error }] = useMutation(UPDATE_PRODUCT, {\n        onCompleted: data => {\n            //console.log(data)\n            setEdit(false)\n        },\n        refetchQueries: [{ query: QUERY_PRODUCTS }, { query: MY_PRODUCTS }]\n    })\n\n    const handleChange = e => setProductData({\n        ...productData,\n        [e.target.name]: e.target.value\n    })\n\n    const selectFile = e => {\n        const files = e.target.files\n        setFile(files[0])\n        //console.log(files)\n    }\n\n    //Upload File to Cloudinary\n    const uploadFile = async () => {\n        const data = new FormData()\n        data.append('file', file)\n        data.append('upload_preset', 'shoppin')\n        const res = await fetch('https://api.cloudinary.com/v1_1/swizce/image/upload', {\n            method: 'post',\n            body: data\n        })\n\n        const result = await res.json()\n\n       // console.log(result)\n    }\n    const handleSubmit = async () => {\n        if (!file && productData === product) {\n            setProductData(product)\n            setEdit(false)\n            return\n        }\n\n       // console.log('Product Result:', productData)\n        try {\n            if (file) {\n                const url = await uploadFile()\n                if (url) {\n                    await updateProduct({\n                        variables: {\n                            ...productData,\n                            imageUrl: url,\n                            price: +productData.price\n                        }\n                    })\n                } else {\n                    await updateProduct({\n                        variables: {\n                            ...productData,\n                            imageUrl: productData.imageUrl,\n                            price: +productData.price\n                        }\n                    })\n                }\n            }\n\n        } catch (error) {\n            console.log(error)\n        }\n    }\n    return (\n        <div style={{\n            display: 'grid',\n            gridTemplateColumns: '2fr 2fr 2fr 2fr 2fr',\n            width: '100%',\n            borderTop: '1px solid grey',\n            borderBottom: '1px solid grey'\n        }}\n        >\n            <div style={{ margin: 'auto', alignItems: 'center', marginBottom: '5px' }}>\n                {!edit ? <img src={product.imageUrl} alt={product.description} width='80px' /> :\n                    <input style={{ margin: '5px', height: '30px' }}\n                        type=\"file\"\n                        name=\"file\"\n                        placeholder=\"Enter Product Image\"\n                        //value={productData.imageUrl}\n                        onChange={selectFile}\n                    />\n                }\n            </div>\n            <div style={{ margin: 'auto', alignItems: 'center', marginBottom: '5px' }}>\n                {!edit ? <p>{product.name}</p> :\n                    <input style={{ margin: '5px', height: '30px' }}\n                        type=\"text\"\n                        name=\"name\"\n                        placeholder=\"Enter product name\"\n                        value={productData.name}\n                        onChange={handleChange}\n                    />\n                }\n            </div>\n            <div style={{ margin: 'auto', alignItems: 'center', marginBottom: '5px' }}>\n                {!edit ? <p>{product.description}</p> :\n                    <input style={{ margin: '5px', height: '30px' }}\n                        type=\"text\"\n                        name=\"description\"\n                        placeholder=\"Enter product description\"\n                        value={productData.description}\n                        onChange={handleChange}\n                    />\n                }\n            </div>\n            <div style={{ margin: 'auto', alignItems: 'center', marginBottom: '5px' }}>\n                {!edit ? <p>{product.price}THB</p> :\n                    <input style={{ margin: '5px', height: '30px' }}\n                        type=\"number\"\n                        name=\"price\"\n                        placeholder=\"Enter Product Price\"\n                        value={productData.price}\n                        onChange={handleChange}\n                    />\n                }\n            </div>\n            {!edit ? <>\n                <div style={{ margin: '5px', alignItems: 'center', display: 'flex', alignItems: 'center' }}>\n                    <button style={{ margin: '10px', background: 'orange', color: 'white', padding: '10px', border: 'none' }} onClick={() => setEdit(true)}>Edit</button>\n                    <button style={{ margin: '10px', background: 'red', color: 'white', padding: '10px', border: 'none' }}>Delete</button>\n                </div>\n            </> :\n                <>\n                    <div style={{ margin: '5px', alignItems: 'center', display: 'flex', alignItems: 'center' }}>\n                        <button style={{ margin: '10px', background: 'orange', color: 'white', padding: '10px', border: 'none' }} onClick={() => setEdit(false)}>Cancel</button>\n                        <button style={{ margin: '10px', background: 'teal', color: 'white', padding: '10px', border: 'none' }} loading={true} onClick={handleSubmit}>{loading ? 'Editing...' : 'Updated'}</button>\n                    </div>\n                </>\n            }\n        </div>\n    )\n}\n\nexport default UserProductItem;"]},"metadata":{},"sourceType":"module"}