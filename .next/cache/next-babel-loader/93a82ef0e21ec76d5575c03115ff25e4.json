{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component, useState } from 'react';\nimport ProductList from './ProductList';\nimport Backdrop from '../Backdrop';\nimport Modal from '../Modal';\nimport { useMutation } from '@apollo/react-hooks';\nimport fetch from 'isomorphic-unfetch';\nimport Router from 'next/router';\nimport { QUERY_PRODUCTS, CREATE_PRODUCT, UPDATE_PRODUCT, MY_PRODUCTS } from '../../graphql/Products';\n\nvar UserProduct = /*#__PURE__*/function (_Component) {\n  _inherits(UserProduct, _Component);\n\n  var _super = _createSuper(UserProduct);\n\n  function UserProduct() {\n    var _this;\n\n    _classCallCheck(this, UserProduct);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      creating: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"CreateEventHandler\", function () {\n      _this.setState({\n        creating: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"modalConfirmHandler\", function () {\n      _this.setState({\n        creating: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"modalCancelHandler\", function () {\n      _this.setState({\n        creating: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_renderCreateProduct\", function () {\n      return function () {\n        var _useState = useState(false),\n            edit = _useState[0],\n            setEdit = _useState[1];\n\n        var _useState2 = useState(null),\n            file = _useState2[0],\n            setFile = _useState2[1];\n\n        var _useState3 = useState({\n          name: '',\n          description: '',\n          price: '',\n          stockqty: '',\n          imageUrl: ''\n        }),\n            productData = _useState3[0],\n            setProductData = _useState3[1];\n\n        var _useMutation = useMutation(CREATE_PRODUCT, {\n          refetchQueries: [{\n            query: QUERY_PRODUCTS\n          }]\n        }),\n            _useMutation2 = _slicedToArray(_useMutation, 2),\n            createProduct = _useMutation2[0],\n            _useMutation2$ = _useMutation2[1],\n            loading = _useMutation2$.loading,\n            error = _useMutation2$.error;\n\n        var handleChange = function handleChange(e) {\n          return setProductData(_objectSpread(_objectSpread({}, productData), {}, _defineProperty({}, e.target.name, e.target.value)));\n        };\n\n        var selectFile = function selectFile(e) {\n          var files = e.target.files;\n          setFile(files[0]); //console.log(files)\n        }; //Upload File to Cloudinary\n\n\n        var uploadFile = /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n            var data, res, result;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    data = new FormData();\n                    data.append('file', file);\n                    data.append('upload_preset', 'shoppin');\n                    _context.next = 5;\n                    return fetch('https://api.cloudinary.com/v1_1/swizce/image/upload', {\n                      method: 'post',\n                      body: data\n                    });\n\n                  case 5:\n                    res = _context.sent;\n                    _context.next = 8;\n                    return res.json();\n\n                  case 8:\n                    result = _context.sent;\n                    return _context.abrupt(\"return\", result.secure_url);\n\n                  case 10:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee);\n          }));\n\n          return function uploadFile() {\n            return _ref.apply(this, arguments);\n          };\n        }();\n\n        var handleSubmit = /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n            var url, result;\n            return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    _context2.prev = 0;\n                    e.preventDefault();\n                    _context2.next = 4;\n                    return uploadFile();\n\n                  case 4:\n                    url = _context2.sent;\n\n                    if (!url) {\n                      _context2.next = 10;\n                      break;\n                    }\n\n                    _context2.next = 8;\n                    return createProduct({\n                      variables: _objectSpread(_objectSpread({}, productData), {}, {\n                        price: +productData.price,\n                        imageUrl: url\n                      })\n                    });\n\n                  case 8:\n                    result = _context2.sent;\n                    return _context2.abrupt(\"return\", result);\n\n                  case 10:\n                    Router.push('/userProducts');\n                    _context2.next = 16;\n                    break;\n\n                  case 13:\n                    _context2.prev = 13;\n                    _context2.t0 = _context2[\"catch\"](0);\n                    console.log(_context2.t0);\n\n                  case 16:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, _callee2, null, [[0, 13]]);\n          }));\n\n          return function handleSubmit(_x) {\n            return _ref2.apply(this, arguments);\n          };\n        }();\n\n        return __jsx(\"div\", {\n          className: \"create-product__Card\"\n        }, __jsx(\"form\", {\n          onSubmit: handleSubmit\n        }, __jsx(\"div\", {\n          className: \"form-control\"\n        }, __jsx(\"label\", {\n          htmlFor: \"productname\"\n        }, \"Product Name:\"), __jsx(\"input\", {\n          type: \"text\",\n          name: \"name\",\n          placeholder: \"Enter Product Name\",\n          value: productData.name,\n          onChange: handleChange\n        })), __jsx(\"div\", {\n          className: \"form-control\"\n        }, __jsx(\"label\", {\n          htmlFor: \"address\"\n        }, \"Product Desc:\"), __jsx(\"textarea\", {\n          type: \"text\",\n          name: \"description\",\n          placeholder: \"Product Description\",\n          value: productData.description,\n          onChange: handleChange,\n          rows: \"4\"\n        })), __jsx(\"div\", {\n          className: \"form-control\"\n        }, __jsx(\"label\", {\n          htmlFor: \"city\"\n        }, \"Price:\"), __jsx(\"input\", {\n          type: \"number\",\n          name: \"price\",\n          placeholder: \"Price\",\n          value: productData.price,\n          onChange: handleChange\n        })), __jsx(\"div\", {\n          className: \"form-control\"\n        }, __jsx(\"label\", {\n          htmlFor: \"stockqty\"\n        }, \"Stock Qty:\"), __jsx(\"input\", {\n          type: \"number\",\n          name: \"stockqty\",\n          placeholder: \"Stock Qualtity\",\n          value: productData.stockqty,\n          onChange: handleChange\n        })), __jsx(\"div\", {\n          className: \"form-control\"\n        }, __jsx(\"label\", {\n          htmlFor: \"contact\"\n        }, \"--Select Categories--\"), __jsx(\"input\", {\n          type: \"text\",\n          name: \"contact\",\n          placeholder: \"Contact No.\"\n        })), __jsx(\"div\", {\n          className: \"form-control\"\n        }, __jsx(\"label\", {\n          htmlFor: \"contact\"\n        }, \"--Select Brands--\"), __jsx(\"input\", {\n          type: \"text\",\n          name: \"contact\",\n          placeholder: \"Contact No.\"\n        })), __jsx(\"div\", {\n          className: \"form-control\"\n        }, __jsx(\"label\", {\n          htmlFor: \"contact\"\n        }, \"Product Image\"), __jsx(\"input\", {\n          type: \"file\",\n          name: \"file\",\n          placeholder: \"file *.png, *.jpg...\",\n          onChange: selectFile\n        })), __jsx(\"div\", {\n          className: \"form-submit\"\n        }, __jsx(\"button\", {\n          className: \"btn__cancel\",\n          onClick: function onClick() {\n            return Router.push('/userProducts');\n          }\n        }, \"Back\"), __jsx(\"button\", {\n          className: \"btn__submit\",\n          type: \"submit\",\n          style: {\n            cursor: !productData.name || !productData.description || !productData.price || !file || loading ? 'not-allowed' : 'pointer'\n          },\n          disabled: !productData.name || !productData.description || !productData.price || !file || loading\n        }, \"Submit\", loading ? 'Submiting...' : ''))));\n      };\n    });\n\n    return _this;\n  }\n\n  _createClass(UserProduct, [{\n    key: \"render\",\n    value: function render() {\n      var CreateForm = this._renderCreateProduct();\n\n      return __jsx(React.Fragment, null, __jsx(\"div\", {\n        className: \"product-content__header\"\n      }, __jsx(\"h2\", {\n        className: \"dash-title\"\n      }, \"All Products List\"), __jsx(\"a\", {\n        onClick: this.CreateEventHandler\n      }, __jsx(\"span\", {\n        className: \"ti-plus\"\n      }), __jsx(\"small\", null, \"Add Product\"))), this.state.creating && __jsx(Backdrop, null), this.state.creating && __jsx(Modal, {\n        title: \"Create Product\",\n        canCancel: true,\n        canConfirm: true,\n        onCancel: this.modalCancelHandler,\n        onConfirm: this.modalConfirmHandler\n      }, __jsx(CreateForm, null)), __jsx(ProductList, null));\n    }\n  }]);\n\n  return UserProduct;\n}(Component);\n\nexport default UserProduct;","map":null,"metadata":{},"sourceType":"module"}