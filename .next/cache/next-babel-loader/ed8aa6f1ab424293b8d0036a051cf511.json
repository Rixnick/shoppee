{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from 'react';\nimport fetch from 'isomorphic-unfetch';\nimport { useMutation } from '@apollo/react-hooks';\nimport { UPDATE_PRODUCT, MY_PRODUCTS, QUERY_PRODUCTS } from '../graphql/Products';\n\nvar UserProductItem = function UserProductItem(_ref) {\n  var product = _ref.product;\n\n  var _useState = useState(false),\n      edit = _useState[0],\n      setEdit = _useState[1];\n\n  var _useState2 = useState(null),\n      file = _useState2[0],\n      setFile = _useState2[1];\n\n  var _useState3 = useState(product),\n      productData = _useState3[0],\n      setProductData = _useState3[1]; //Create State\n  // const [productData, setProductData] = useState({\n  //   name: '',\n  //   description: '',\n  //   price: '',\n  //   imageUrl: ''\n  // })\n\n\n  var _useMutation = useMutation(UPDATE_PRODUCT, {\n    onCompleted: function onCompleted(data) {\n      console.log(data);\n    },\n    refetchQueries: [{\n      query: QUERY_PRODUCTS\n    }, {\n      query: MY_PRODUCTS\n    }]\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      updateProduct = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      loading = _useMutation2$.loading,\n      error = _useMutation2$.error;\n\n  var handleChange = function handleChange(e) {\n    return setProductData(_objectSpread(_objectSpread({}, productData), {}, _defineProperty({}, e.target.name, e.target.value)));\n  };\n\n  var selectFile = function selectFile(e) {\n    var files = e.target.files;\n    setFile(files[0]);\n    console.log(files);\n  }; //Upload File to Cloudinary\n\n\n  var uploadFile = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var data, res, result;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              data = new FormData();\n              data.append('file', file);\n              data.append('upload_preset', 'shoppin');\n              _context.next = 5;\n              return fetch('https://api.cloudinary.com/v1_1/swizce/image/upload', {\n                method: 'post',\n                body: data\n              });\n\n            case 5:\n              res = _context.sent;\n              _context.next = 8;\n              return res.json();\n\n            case 8:\n              result = _context.sent;\n              console.log(result);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function uploadFile() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(!file && productData === product)) {\n                _context2.next = 4;\n                break;\n              }\n\n              setProductData(product);\n              setEdit(false);\n              return _context2.abrupt(\"return\");\n\n            case 4:\n              console.log(productData);\n\n              try {// if(file){\n                //   const url = await uploadFile()\n                //   if(url) {\n                //      await updateProduct({\n                //       variables: {\n                //         ...productData,\n                //         imageUrl: url,\n                //         price: +productData.price\n                //       }\n                //     })\n                //   } else {\n                //     await updateProduct({\n                //       variables: {\n                //         ...productData,\n                //         imageUrl: productData.imageUrl,\n                //         price: +productData.price\n                //       }\n                //     })\n                //   }\n                // }\n              } catch (error) {\n                console.log(error);\n              }\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleSubmit() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    style: {\n      display: 'grid',\n      gridTemplateColumns: '2fr 2fr 2fr 2fr 2fr',\n      width: '100%',\n      borderTop: '1px solid grey',\n      borderBottom: '1px solid grey'\n    }\n  }, __jsx(\"div\", {\n    style: {\n      margin: 'auto',\n      alignItems: 'center',\n      marginBottom: '5px'\n    }\n  }, !edit ? __jsx(\"img\", {\n    src: product.imageUrl,\n    alt: product.description,\n    width: \"80px\"\n  }) : __jsx(\"input\", {\n    style: {\n      margin: 'auto',\n      alignItems: 'center',\n      marginBottom: '5px'\n    },\n    type: \"file\",\n    name: \"file\",\n    onChange: selectFile\n  })), __jsx(\"div\", {\n    style: {\n      margin: 'auto',\n      alignItems: 'center',\n      marginBottom: '5px'\n    }\n  }, !edit ? __jsx(\"p\", null, product.name) : __jsx(\"input\", {\n    style: {\n      margin: '5px',\n      height: '30px'\n    },\n    type: \"text\",\n    name: \"name\",\n    value: product.name,\n    onChange: handleChange\n  })), __jsx(\"div\", {\n    style: {\n      margin: 'auto',\n      alignItems: 'center',\n      marginBottom: '5px'\n    }\n  }, !edit ? __jsx(\"p\", null, product.description) : __jsx(\"input\", {\n    style: {\n      margin: '5px',\n      height: '30px'\n    },\n    type: \"text\",\n    name: \"description\",\n    value: product.description,\n    onChange: handleChange\n  })), __jsx(\"div\", {\n    style: {\n      margin: 'auto',\n      alignItems: 'center',\n      marginBottom: '5px'\n    }\n  }, !edit ? __jsx(\"p\", null, product.price, \"THB\") : __jsx(\"input\", {\n    style: {\n      margin: '5px',\n      height: '30px'\n    },\n    type: \"text\",\n    name: \"price\",\n    value: product.price,\n    onChange: handleChange\n  })), !edit ? __jsx(React.Fragment, null, __jsx(\"div\", {\n    style: _defineProperty({\n      margin: '5px',\n      alignItems: 'center',\n      display: 'flex'\n    }, \"alignItems\", 'center')\n  }, __jsx(\"button\", {\n    style: {\n      margin: '10px',\n      background: 'orange',\n      color: 'white',\n      padding: '10px',\n      border: 'none'\n    },\n    onClick: function onClick() {\n      return setEdit(true);\n    }\n  }, \"Edit\"), __jsx(\"button\", {\n    style: {\n      margin: '10px',\n      background: 'red',\n      color: 'white',\n      padding: '10px',\n      border: 'none'\n    }\n  }, \"Delete\"))) : __jsx(React.Fragment, null, __jsx(\"div\", {\n    style: _defineProperty({\n      margin: '5px',\n      alignItems: 'center',\n      display: 'flex'\n    }, \"alignItems\", 'center')\n  }, __jsx(\"button\", {\n    style: {\n      margin: '10px',\n      background: 'orange',\n      color: 'white',\n      padding: '10px',\n      border: 'none'\n    },\n    onClick: function onClick() {\n      return setEdit(false);\n    }\n  }, \"Cancel\"), __jsx(\"button\", {\n    style: {\n      margin: '10px',\n      background: 'teal',\n      color: 'white',\n      padding: '10px',\n      border: 'none'\n    },\n    onClick: handleSubmit\n  }, \"Update\"))));\n};\n\nexport default UserProductItem;","map":null,"metadata":{},"sourceType":"module"}